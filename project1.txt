#!/bin/bash

#constants
TITLE="System Information For $HOSTNAME"
CURRENTTIME="$(date +"%x %r %z")"
TIMESTAMP="Updated on $CURRENTTIME by $USER"
#FUNCTIONS
home_space() {
    echo "<h2>Home directory space by user</h2>"
    echo "<pre>"
    echo "Bytes User"
    du -s /home/* | sort -nr
    echo "</pre>"
}

system_info() {
	echo "<h2>System Info</h2>"
	echo "<pre>"
	uname -or
	echo "</pre>"
}

system_uptime(){
	echo "<h2>System uptime</h2>"
	echo "<pre>"
	uptime
	echo "</pre>"
}

system_memory() {
	echo "<h2>Filesystem space</h2>"
	echo "<pre>"
	df
	echo "</pre>"
}

system_ip() {
	echo "<h2>IP Address</h2>"
	echo "<pre>"
	$ ip addr show eth0 | grep 'inet ' | awk '{print $2}' | cut -f1 -d'/'
	echo "<pre>"
}
generate_report_title(){
	echo "<h1>$TITLE</h1>"
	echo "<h2>$TIMESTAMP</h2>"
}



#MAIN
if [ "$(id -u)" = "0" ]; then
	echo <<- _EOF_
		<html>
		<head>
				<title>
				$(generate_report_title)
				</title>
		</head>
		<body>
		$(home_space)
		$(system_uptime)
		$(system_info)
		$(system_memory)
		</body>
		</html>
	_EOF_
else
	echo "please run as root"
fi